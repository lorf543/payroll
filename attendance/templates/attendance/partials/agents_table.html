{% for agent in team_members %}
<tr>
    <td>
        <div class="d-flex align-items-center">
            <div class="agent-avatar me-3">
                <span class="initials">{{ agent.user.first_name.0 }}{{ agent.user.last_name.0 }}</span>
            </div>
            <div>
                <strong>{{ agent.full_name }}</strong>
                <div class="small text-muted">{{ agent.employee_code }}</div>
            </div>
        </div>
    </td>
    <td>{{ agent.position.name|default:"-" }}</td>
    <td>
        {% if agent.id in agent_status_map %}
            {% with status=agent_status_map.agent.id %}
            <span class="badge status-{{ status.status }} px-3 py-2">
                {{ status.status|title }}
            </span>
            {% endwith %}
        {% else %}
            <span class="badge status-offline px-3 py-2">Offline</span>
        {% endif %}
    </td>
    <td>
        {% if agent.id in agent_status_map %}
            {% with status=agent_status_map.agent.id %}
            <span class="duration" data-start-time="{{ status.start_time|date:'c' }}">
                {{ status.start_time|timesince:current_time }}
            </span>
            {% endwith %}
        {% else %}
            -
        {% endif %}
    </td>
    <td>
        {% if agent.id in agent_status_map %}
            {% with status=agent_status_map.agent.id %}
            {{ status.start_time|date:"M j, g:i A" }}
            {% endwith %}
        {% else %}
            -
        {% endif %}
    </td>
    <td>
        <div class="btn-group btn-group-sm">
            <a href="{% url 'employees_detail' agent.id %}" 
            class="btn btn-outline-primary" 
            title="View Profile">
                <i class="bi bi-person"></i>
            </a>
        </div>
    </td>
</tr>
{% empty %}
<tr>
    <td colspan="6" class="text-center text-muted py-4">
        <i class="bi bi-people display-4 d-block mb-2"></i>
        No team members assigned
    </td>
</tr>
{% endfor %}